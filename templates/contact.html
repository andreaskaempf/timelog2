{{ template "header.html" . }}

  <h1 class="title">
    {{ .c.FirstName }} {{ .c.LastName }}
    <div style="float: right">
      <a href="/edit_contact/{{ .c.Id }}" class="button is-small is-primary" style="margin-right: 0.5em;">Edit</a>
      <button onclick="confirmContactDeletion({{ .c.Id }}, this)" class="button is-small is-danger">Delete</button>
    </div>
  </h1>

  <div class="content">
    <table class="table">
      <tbody>
        <tr>
          <th>Name</th>
          <td>{{ .c.FirstName }} {{ .c.LastName }}</td>
        </tr>
        <tr>
          <th>Company</th>
          <td>{{ .c.Company }}</td>
        </tr>
        <tr>
          <th>Title</th>
          <td>{{ .c.Title }}</td>
        </tr>
        <tr>
          <th>Source</th>
          <td>{{ .c.Source }}</td>
        </tr>
        <tr>
          <th>Phone(s)</th>
          <td>{{ .c.Phones }}</td>
        </tr>
        <tr>
          <th>Email(s)</th>
          <td>{{ .c.Emails }}</td>
        </tr>
        <tr>
          <th>Address</th>
          <td>{{ .c.Address }}</td>
        </tr>
        <tr>
          <th>Comments</th>
          <td>{{ .c.Comments }}</td>
        </tr>
        <tr>
          <th>Active</th>
          <td>
            {{ if .c.Active }}
              <span class="tag is-success">Active</span>
            {{ else }}
              <span class="tag is-danger">Inactive</span>
            {{ end }}
          </td>
        </tr>
      </tbody>
    </table>

    <h2 class="subtitle" style="margin-top: 2rem;">Linked Projects</h2>
    {{ if .projects }}
    <table class="table is-fullwidth">
      <thead>
        <tr>
          <th style="width: 30%;">Client</th>
          <th style="width: 30%;">Project</th>
          <th style="width: 30%;">Category</th>
          <th style="width: 10%;"></th>
        </tr>
      </thead>
      <tbody>
        {{ range .projects }}
        <tr>
          <td><a href="/project/{{ .Id }}">{{ .Client }}</a></td>
          <td>{{ .Name }}</td>
          <td>{{ .Category }}</td>
          <td><button onclick="confirmProjectLinkDeletion({{ $.c.Id }}, {{ .Id }}, '{{ .Name }}')"
                class="button is-small is-danger is-light">Remove</button></td>
        </tr>
        {{ end }}
      </tbody>
    </table>
    {{ else }}
    <p>No projects linked to this contact yet.</p>
    {{ end }}

    {{ if .newProjects }}
    <div style="margin-top: 1rem;">
      <form action="/add_contact_project/{{ .c.Id }}" method="POST" style="display: flex; gap: 0.5rem; align-items: center;">
        <div class="select">
          <select name="project_id" required>
            <option value="">Select a project...</option>
            {{ range .newProjects }}
            <option value="{{ .Id }}">{{ .Client }} - {{ .Name }}</option>
            {{ end }}
          </select>
        </div>
        <button type="submit" class="button is-small is-primary">Link Project</button>
      </form>
    </div>
    {{ else }}
    <p>No projects available for this contact to link to.</p>
    {{ end }}

  </div>

{{ template "footer.html" .}}

